<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HydReq GUI</title>
  <!-- DaisyUI (includes Tailwind CSS precompiled) for better components/spacing -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css">
  <!-- CodeMirror for YAML editing -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/theme/material-darker.min.css">
  <!-- Custom styles -->
  <link rel="stylesheet" href="themes.css">
  <link rel="stylesheet" href="layout.css">
  <link rel="stylesheet" href="components.css">
  <link rel="stylesheet" href="editor.css">
  <!-- js-yaml for client-side YAML serialization/parsing -->
  <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
  <!-- CodeMirror JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/mode/yaml/yaml.min.js"></script>
  <!-- Custom JavaScript modules -->
  <script src="js/utils.js"></script>
  <script src="js/suites.js"></script>
  <script src="js/editor.js"></script>
  <script src="js/app.js"></script>
</head>
<body>
  <header>
    <div style="display:flex; align-items:center; gap:12px">
      <img id="hydreq_logo" src="/logo_notext.svg" alt="HydReq" style="height:36px; width:36px; display:block;"/>
      <div>HydReq — Hydra Request</div>
    </div>
    <div class="row m-0">
  <label class="row m-0"><input id="onlyFailed" type="checkbox"/> Only failed</label>
  <label class="row m-0"><input id="autoScroll" type="checkbox"/> Auto-scroll</label>
  <label class="row m-0" title="Theme"><span style="margin-right:6px">Theme</span>
    <select id="themeSelect">
      <option value="light">Light</option>
      <option value="dark">Dark</option>
      <option value="synthwave">Synthwave</option>
      <option value="hack">Hack</option>
      <option value="catppuccin-mocha">Catppuccin Mocha</option>
      <option value="catppuccin-latte">Catppuccin Latte</option>
    </select>
  </label>
  <button id="run" class="btn btn-sm btn-primary" title="Run selected test suites">Run Selected</button>
  <span class="pill badge" id="selCount">0 selected</span>
  <button id="cancel" class="btn btn-sm btn-error" title="Cancel current run (s)">Stop</button>
    </div>
  </header>
  <main>
    <aside>
  <div class="row">
  <button id="refresh" class="btn btn-sm" title="Rescan testdata for *.yaml suites">Refresh</button>
    <button id="newSuiteBtn" class="btn btn-sm" title="Create a new test suite">New Suite</button>
    <label>Workers <input id="workers" type="number" min="1" max="64" value="4" class="w-64px"/></label>
        <label>Tags <input id="tags" type="text" placeholder="smoke,slow" class="w-120px"/></label>
        <label>Default timeout (ms) <input id="defaultTimeout" type="number" min="0" placeholder="30000" class="w-120px"/></label>
      </div>
      <details>
        <summary>Env overrides</summary>
        <div class="row">
          <textarea id="env_kv" placeholder="KEY=VALUE (one per line)" class="w-full h-80px"></textarea>
        </div>
        <div class="row wrap gap-4px" id="env_active"></div>
      </details>
      <details>
        <summary>Import Collection</summary>
        <div class="row">
          <select id="importFormat" class="w-full">
            <option value="postman">Postman Collection (JSON)</option>
            <option value="insomnia">Insomnia Export (JSON)</option>
            <option value="har">HAR Archive (JSON)</option>
            <option value="openapi">OpenAPI/Swagger Spec (YAML/JSON)</option>
            <option value="bruno">Bruno Export (JSON)</option>
            <option value="restclient">REST Client (.http)</option>
            <option value="newman">Newman Collection (JSON)</option>
          </select>
        </div>
        <div class="row">
          <input type="file" id="importFile" accept=".json,.yaml,.yml,.har,.http" class="w-full"/>
        </div>
        <div class="row">
          <button id="importBtn" class="btn btn-sm btn-secondary">Import</button>
          <span id="importStatus" class="text-sm ml-2"></span>
        </div>
      </details>
      <div style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
        <button id="expandAll" class="btn btn-sm">Expand all</button>
        <button id="collapseAll" class="btn btn-sm">Collapse all</button>
        <div style="flex:1"></div>
      </div>
      <ul id="suites"></ul>
    </aside>
    <section>
      <div class="row"><div class="flex-1">Batch progress</div><div class="pill" id="batchText">0/0</div></div>
      <div class="progress"><div id="batchBar"></div></div>
      <div class="ed-spacer-8"></div>
  <div class="row"><div class="flex-1">Suite progress — <span id="currentSuite">(none)</span></div><div class="pill" id="suiteText">0/0</div></div>
      <div class="progress"><div id="suiteBar"></div></div>
      <div id="stages"></div>
  <div class="row" style="justify-content:space-between;align-items:center">
    <div class="row ed-row-6 ed-ai-center"><h3 style="margin:0">Results</h3><span class="dim" title="For CI artifacts use CLI flags --report-json / --report-junit">(Reports via CLI)</span></div>
    <div class="row ed-row-6 ed-ai-center">
      <button id="downloadRunJSON" class="btn btn-sm" title="Download run JSON">Download Run JSON</button>
      <button id="downloadRunJUnit" class="btn btn-sm" title="Download run JUnit">Download Run JUnit</button>
      <button id="downloadRunHTML" class="btn btn-sm" title="Download run HTML">Download Run HTML</button>
      <button id="clearLog" class="btn btn-sm" title="Clear the console output">Clear</button>
    </div>
      </div>
      <div id="results" class="log"></div>
    </section>
  </main>
  <script>
    // Global variables - only DOM element references that aren't declared elsewhere
    let currentSuiteEl = document.getElementById('currentSuite');
    let results = document.getElementById('results');
    let batchBar = document.getElementById('batchBar');
    let suiteBar = document.getElementById('suiteBar');
    let batchText = document.getElementById('batchText');
    let suiteText = document.getElementById('suiteText');
    let stages = document.getElementById('stages');
    let selCount = document.getElementById('selCount');
    let tagsEl = document.getElementById('tags');
    let defToEl = document.getElementById('defaultTimeout');
    let workersEl = document.getElementById('workers');
    let themeSelect = document.getElementById('themeSelect');

    // Initialize the application
    initSuites();
  </script>
</body>
</html>
